ORG 00H
MOV 20H, #60H
MOV 21H, #66H
MOV 22H, #0FCH
MOV 23H, #0F2H
MOV 24H, #60H
MOV 25H, #0DAH
MOV 26H, #0B6H
MOV 27H, #0F6H
MOV 28H, #60H
MOV 29H, #66H
MOV 2AH, #0FCH
MOV 2BH, #0F2H
MOV 2CH, #60H
MOV 2DH, #0DAH
MOV 2EH, #0F2H
MOV 2FH, #0B6H

LATCH1 BIT P2.2
LATCH2 BIT P2.3

START: MOV B, #07FH
LOOP1: CALL SCAN1
DJNZ B, LOOP1
MOV B, #07FH
LOOP2: CALL SCAN2
DJNZ B, LOOP2
JMP START

SCAN1: MOV A, #0FEH
MOV R0, #20H
SETB C
MOV R2, #08H
LOOP3: RR A
MOV P0, A
SETB LATCH2
CLR LATCH2
MOV P0, @R0
SETB LATCH1
CLR LATCH1
INC R0
CALL DELAY
DJNZ R2, LOOP3
RET

SCAN2: MOV A, #0FEH
MOV R0, #28H
SETB C
MOV R2, #08H
LOOP4: RR A
MOV P0, A
SETB LATCH2
CLR LATCH2
MOV P0, @R0
SETB LATCH1
CLR LATCH1
INC R0
CALL DELAY
DJNZ R2, LOOP4
RET

DELAY: MOV R3, 1
D1: MOV R4, #1
D2: MOV R5, #1
DJNZ R5, $
DJNZ R4, D2
DJNZ R3, D1
RET
END